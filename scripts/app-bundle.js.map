{"version":3,"sources":["backend/debug-host.ts","app.ts","environment.ts","main.ts","resources/index.ts","resources/elements/debug-expander.ts"],"names":[],"mappings":"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","file":"app-bundle.js","sourcesContent":["import {autoinject} from 'aurelia-dependency-injection';\n\ndeclare var chrome: any;\ndeclare var $0: any;\n\nvar processSelection = function () {\n  function createDebugValue(value) {\n    let type;\n    let debugValue;\n\n    if (value instanceof Node) {\n      type = 'node';\n      debugValue = '[node]';\n    } else if (Array.isArray(value)) {\n      type = 'array';\n      debugValue = '[array]';\n    } else {\n      type = typeof value;\n      debugValue = value;\n    }\n\n    if (type === 'object') {\n      if (value.constructor) {\n        type = debugValue = value.constructor.name;\n      } else {\n        debugValue = '[object]';\n      }\n    }\n\n    return {\n      type: type,\n      value: debugValue\n    };\n  }\n\n  function createControllerDebugInfo(controller) {\n    try {\n      let controllerDebugInfo: any = {};\n      let viewModel = controller.viewModel;\n\n      controllerDebugInfo.bindables = controller.behavior.properties.map(x => {\n        return {\n          name: x.name,\n          attribute: x.attribute,\n          value: createDebugValue(viewModel[x.name])\n        }\n      });\n\n      controllerDebugInfo.properties = Object.keys(viewModel).filter(x => {\n        let found = controllerDebugInfo.bindables.find(x => x.name === x);\n        return !found && !x.startsWith('_');\n      }).map(x => {\n        return {\n          name: x,\n          value: createDebugValue(viewModel[x])\n        };\n      });\n\n      return controllerDebugInfo;\n    } catch (e) {\n      return e.message;\n    }\n  }\n\n  function _getRepeaterContext(node) {\n    var current = node.nextSibling;\n\n    while (current) {\n      if (current.nodeType === 8 && current.viewSlot) {\n        var children = current.viewSlot.children;\n\n        for (var i = 0, ii = children.length; i < ii; ++i) {\n          var view = children[i];\n          var currentChild = view.firstChild\n          var lastChild = view.lastChild;\n          var nextChild;\n\n          while (currentChild) {\n            nextChild = currentChild.nextSibling;\n\n            if (currentChild === node) {\n              return view.bindingContext;\n            }\n\n            if (currentChild === lastChild) {\n              break;\n            }\n\n            currentChild = nextChild;\n          }\n        }\n      }\n\n      current = current.nextSibling;\n    }\n\n    return null;\n  }\n\n  function _getBindingContext(node) {\n    if (!node) {\n      return null;\n    }\n\n    if (node.aurelia) {\n      return node.aurelia.root.viewModel;\n    } else if (node.au) {\n      var au = node.au;\n\n      if (au.controller) { //custom element\n        var controller = au.controller;\n        var tagName = node.tagName ? node.tagName.toLowerCase() : null;\n        var repeaterContext;\n\n        if (tagName === 'router-view') {\n          return controller.viewModel.view.controller.viewModel;\n        } else if (tagName === 'compose') {\n          return controller.viewModel.currentViewModel;\n        } else if (controller['with']) {\n          return controller['with'].viewModel.value;\n        } else if (repeaterContext = _getRepeaterContext(node)) {\n          return repeaterContext;\n        } else {\n\n        }\n      }\n    }\n\n    return _getBindingContext(node.parentNode);\n  }\n\n  function getBindingContext(node) {\n    var repeaterContext;\n\n    if (repeaterContext = _getRepeaterContext(node)) {\n      return repeaterContext;\n    }\n\n    return _getBindingContext(node.parentNode);\n  }\n\n  var selectedNode = $0;\n  var debugInfo: any = {};\n\n  if (selectedNode.au) {\n    var au = selectedNode.au;\n\n    if (au.controller) {\n      debugInfo.customElement = createControllerDebugInfo(au.controller);\n    }\n\n    var tagName = selectedNode.tagName ? selectedNode.tagName.toLowerCase() : null;\n    var customAttributeNames = Object.keys(au).filter(function (key) {\n      return key !== 'controller' && key !== tagName;\n    });\n\n    if (customAttributeNames.length) {\n      debugInfo.customAttributes = customAttributeNames.map(x => createControllerDebugInfo(au[x]));\n    }\n  }\n\n  debugInfo.bindingContext = getBindingContext(selectedNode);\n\n  return debugInfo;\n};\n\nexport class SelectionChanged {\n  constructor(public debugInfo) {}\n}\n\nexport interface IHostConsumer {\n  onSelectionChanged(event: SelectionChanged);\n}\n\n@autoinject\nexport class DebugHost {\n  attach(consumer: IHostConsumer) {\n    let code = \"(\" + processSelection.toString() + \")()\";\n    \n    chrome.devtools.panels.elements.onSelectionChanged.addListener(() => {\n      chrome.devtools.inspectedWindow.eval(code, debugObject => {\n        consumer.onSelectionChanged(new SelectionChanged(debugObject))\n      });\n    });\n\n    chrome.devtools.inspectedWindow.eval(code, debugObject => {\n      consumer.onSelectionChanged(new SelectionChanged(debugObject))\n    });\n  }\n}\n","import {DebugHost, SelectionChanged} from './backend/debug-host';\nimport {autoinject} from 'aurelia-dependency-injection';\n\n@autoinject\nexport class App {\n  debugInfo: any;\n\n  constructor(private debugHost: DebugHost) {}\n\n  attached() {\n    this.debugHost.attach(this);\n  }\n\n  onSelectionChanged(event: SelectionChanged) {\n    this.debugInfo = event.debugInfo;\n  }\n}\n\nexport class StringifyValueConverter {\n  toView(value) {\n    return JSON.stringify(value);\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import {Aurelia} from 'aurelia-framework'\nimport environment from './environment';\n\n//Configure Bluebird Promises.\n(<any>Promise).config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia: Aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","import {FrameworkConfiguration} from 'aurelia-framework';\n\nexport function configure(config: FrameworkConfiguration) {\n  config.globalResources([\n    './elements/aurelia-logo.html',\n    './elements/debug-expander'\n  ]);\n}\n","import {bindable} from 'aurelia-templating';\n\nexport class DebugExpander {\n  @bindable heading: string;\n  isExpanded: boolean = true;\n}\n"],"sourceRoot":"../src"}